<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>TME Comparison | Sindhura Thirumal</title> <meta name="author" content="Sindhura Thirumal"/> <meta name="description" content="A qualitative evaluation of the tumour microenvironments between biopsy and cystectomy bladder cancer samples."/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img//assets/img/employee.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://sindhurathiru.github.io/projects/tme_comparison/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Sindhura </span>Thirumal</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">portfolio</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/Resume%20-%20Sindhura%20Thirumal.pdf">resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">TME Comparison</h1> <p class="post-description">A qualitative evaluation of the tumour microenvironments between biopsy and cystectomy bladder cancer samples.</p> </header> <article> <div class="row justify-content-sm-center" style="background-color: #fbf2fb"> <div class="col-sm-4 mt-3"> <h3 style="color: #b87bd0">Goal</h3> <p style="color: #b87bd0">Conduct a preliminary analysis to demonstrate the application of machine learning in an automated pipeline to study the tumour microenvironment in matched biopsy and cystectomy bladder cancer tissue samples.</p> </div> <div class="col-sm-8 mt-3"> <h3 style="color: #b87bd0">Result</h3> <p style="color: #b87bd0">The proteomic profiles of biopsy tissues seem to follow a very siimilar distribution as the matched cystectomy tissues. The similar expression profiles indicate the possibility for pathologists to deduce the same information obtained from a cystectomy sample, but from a biopsy sample instead. In doing so, clinicians would be able to administer proper treatment to the patient without having to wait for a cystectomy.</p> </div> </div> <p><br></p> <p>An important issue surrounding bladder cancers is the delay in administering adequate treatment for the patient. A patient will have an initial transurethral resection of bladder tumour which involves a biopsy, and then followed up with a cystectomy, which is used to determine the treatment plan. The time between the two procedures can be extensive and results in unwanted progression of the cancer before the patient can undergo the cystectomy. If a pathologist is able to deduce the information obtained through a cystectomy sample from the biopsy sample instead, this issue will become redundant.</p> <p>In the past, CD8+ T cells have been <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0205746" target="_blank" rel="noopener noreferrer">shown</a> to be associated with MIBC patients’ overall survival. Here, we analyze and compare the proteomic profiles of the biopsy and cystectomy tissues to identify possible similarities, with a specific interest in CD8+ T cell expressions. We take an unsupervised approach and perform a qualitative analysis using a deep autoencoder. The autoencoder is used to reduce the dimensionality of the data and the resulting distribution is evaluated for similarities.</p> <h2>Data &amp; Pre-processing</h2> <p>There are 30 biopsy samples from 15 bladder cancer patients along with 30 matched cystectomy samples for each patient. Protein expression data for 22 protein markers was obtained and cell masks were generated using <a href="https://sindhurathiru.github.io/projects/2_project/">TITAN’s</a> segmentation function and mean intensity information of each cell was obtained. The mean intensity of a protein within a given cell indicates the protein expression levels. The resulting dataset is a matrix where each row represents a cell and each column contains the mean expression level of a given protein for that cell. This dataset was normalized and outliers were removed before model training. Outliers were determined as data points lying greater than 4 standard deviations away from the mean. These points likely contain background noise and may negatively impact the comparison. We used <a href="https://www.sciencedirect.com/science/article/pii/S0092867415006376" target="_blank" rel="noopener noreferrer">PhenoGraph</a> on the log-transformed dataset to cluster phenotypically similar cells phenograph. A pathologist then used the protein expression levels of each cluster to manually annotate the phenotype of the cells within a given cluster.</p> <h2>Network</h2> <p>The model used is an autoencoder for an unsupervised approach in order to obtain a qualitative comparison of the distribution of cell types between biopsy and cystectomy tissue samples. An autoencoder was chosen since it allows for visualization of the data in a lower dimensional space through use of the encoding layer, referred to herein as the latent space. The latent space ultimately provides a more informative understanding of the dataset in its entirety.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/autoencoder-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/autoencoder-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/autoencoder-1400.webp"></source> <img src="/assets/img/autoencoder.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="autoencoder" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Each layer of the autoencoder uses a ReLU activation function, with the final encoding and decoding layer using a linear and sigmoid activation function respectively. The network was trained using the Adam optimization function with a learning rate of 5e<sup>-5</sup>. The mean squared error was calculated and back-propagated throughout training of the network. A latent space of dimension size 2 was used in order for optimal visualization of data results.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td> <td class="code"><pre>    <span class="n">adam</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">optimizers</span><span class="p">.</span><span class="nc">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.00005</span><span class="p">)</span>
    <span class="n">bottleneck_size</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># number of dimensions to view latent space in; same as "code size"
</span>    <span class="n">input_data</span> <span class="o">=</span> <span class="nc">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">23</span><span class="p">,))</span> <span class="c1"># number of columns
</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="nc">Dense</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)(</span><span class="n">input_data</span><span class="p">)</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="nc">Dense</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)(</span><span class="n">encoded</span><span class="p">)</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="nc">Dense</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)(</span><span class="n">encoded</span><span class="p">)</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="nc">Dense</span><span class="p">(</span><span class="n">bottleneck_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">linear</span><span class="sh">'</span><span class="p">)(</span><span class="n">encoded</span><span class="p">)</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="nc">Model</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">encoded</span><span class="p">)</span>

    <span class="n">encoded_input</span> <span class="o">=</span> <span class="nc">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">bottleneck_size</span><span class="p">,))</span>
    <span class="n">decoded</span> <span class="o">=</span> <span class="nc">Dense</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)(</span><span class="n">encoded_input</span><span class="p">)</span>
    <span class="n">decoded</span> <span class="o">=</span> <span class="nc">Dense</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)(</span><span class="n">decoded</span><span class="p">)</span>
    <span class="n">decoded</span> <span class="o">=</span> <span class="nc">Dense</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)(</span><span class="n">decoded</span><span class="p">)</span>
    <span class="n">decoded</span> <span class="o">=</span> <span class="nc">Dense</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">sigmoid</span><span class="sh">'</span><span class="p">)(</span><span class="n">decoded</span><span class="p">)</span>
    <span class="n">decoder</span> <span class="o">=</span> <span class="nc">Model</span><span class="p">(</span><span class="n">encoded_input</span><span class="p">,</span> <span class="n">decoded</span><span class="p">)</span>

    <span class="n">output_data</span> <span class="o">=</span> <span class="nf">decoder</span><span class="p">(</span><span class="nf">encoder</span><span class="p">(</span><span class="n">input_data</span><span class="p">))</span>
    <span class="n">ae</span> <span class="o">=</span> <span class="nc">Model</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">output_data</span><span class="p">)</span>
    <span class="n">ae</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">adam</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="sh">'</span><span class="s">binary_crossentropy</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># using binary cross entropy since input values are in range [0,1]</span>
</pre></td> </tr></tbody></table></code></pre></figure> <h2>Experiments</h2> <p>The dataset was split into training and validation sets through random stratification based on cell type. SMOTE was then used to over-sample the training set in order to balance the classes for better model training. The autoencoder was trained on the training set while validating with the validation set. In an effort to prevent overfitting, early stopping with a patience of 10 was incorporated to halt model training based on the validation loss. The accuracy of the autoencoder reconstruction was evaluated and validated by visually analyzing the differences between the decoded data and the true data. Once validated, the latent space is thoroughly investigated to determine how the biopsy and cystectomy tissue samples compare between each other.</p> <h2>Network Validation</h2> <p>The autoencoder trained for 203 epochs and resulted in a validation loss of 0.065. In order to validate the accuracy of the reconstruction, we calculated and plotted the percent error of the reconstructed values based on each feature range.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/barplot%20variance-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/barplot%20variance-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/barplot%20variance-1400.webp"></source> <img src="/assets/img/barplot%20variance.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="boxplot" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The median percent error of the predicted data points for all features is 3.1\%. Overall, the reconstruction of data remained fairly similar to the true data, indicating effective performance of the autoencoder.</p> <h2>Latent Space Evaluation</h2> <p><br></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/latentspace-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/latentspace-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/latentspace-1400.webp"></source> <img src="/assets/img/latentspace.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="boxplot" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The data points are coloured based on whether they are cells found in the biopsy or cystectomy tissue. As shown, there is significant overlap of the distribution of the data points between both tissue sample types. When represented in two dimensions, cells in both biopsy and cystectomy tissues fall along the same distribution. This would indicate that the protein expression between the two tissue types are relatively similar. In order to further evaluate the similarities, we look at the latent space of specific cell types individually.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/latentspace1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/latentspace1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/latentspace1-1400.webp"></source> <img src="/assets/img/latentspace1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/latentspace2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/latentspace2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/latentspace2-1400.webp"></source> <img src="/assets/img/latentspace2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/latentspace3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/latentspace3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/latentspace3-1400.webp"></source> <img src="/assets/img/latentspace3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Distribution of macrophages (left), CD8+ T cells (middle), CD4+ T cells (right). </div> <p>Evidently, the distribution of macrophages and CD8+ T cells are very comparable between the biopsy and cystectomy tissue. Based on these findings, we can deduce that the protein expression of macrophages and CD8+ T cells in a patient’s biopsy sample may be similar to their cystectomy sample. As mentioned earlier, CD8+ T cells have been linked to correlating with MIBC patients’ prognosis. The similarity of CD8+ T cell expression between the biopsy and cystectomy tissues is promising and promotes the possibility of the biopsy CD8+ T cell information to be used as a surrogate of the cystectomy tissue. The distribution of CD4+ T cells has slight overlap although not as significant as the macrophages and CD8+ T cells. This likely indicates that CD4+ T cell expression in a biopsy sample may not be informative of the expected expression of these cells in the matched cystectomy sample. In the past, however, CD4+ T cell content has been shown to have an effect on survival in MIBC patients. Thus, it would be beneficial to investigate this further.</p> <p><b>NOTE:</b> This dataset contains samples from only 15 patients overall, so it is impractical to make any definitive biological claims with our analyses. The work in this chapter is very preliminary and mainly provides an overview of what kind of expression profile can be expected from biopsy and cystectomy tissue. With a larger dataset, we would be able to validate the distributions of the biopsy and cystectomy samples to confirm the similarities seen.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2026 Sindhura Thirumal. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>